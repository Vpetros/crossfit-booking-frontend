<h3 class="h5 mb-3">
  Welcome {{ username }}, book your next WOD and let the pump start.
</h3>

<div *ngIf="loading" class="text-muted">Loading…</div>

<div *ngIf="!loading && error" class="alert alert-danger">
  {{ error }}
</div>

<div *ngIf="!loading && !error" class="row g-3">
  <!-- Today's workout card -->
  <div class="col-12 col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <h4 class="h6 mb-2">Today’s workout</h4>

        <div *ngIf="!todaysSlots.length" class="text-muted">
          No slots found for today.
        </div>

        <div *ngIf="todaysSlots.length">
          <div class="mb-2" *ngIf="todaysWorkoutText; else noWodTpl">
            <div class="text-muted small mb-1">WOD</div>
            <div style="white-space: pre-wrap">{{ todaysWorkoutText }}</div>
          </div>

          <ng-template #noWodTpl>
            <div class="text-muted">No workout posted yet for today.</div>
          </ng-template>

          <hr />

          <div class="text-muted small mb-2">Today’s slots</div>
          <div class="d-flex flex-wrap gap-2">
            <span class="badge text-bg-light border" *ngFor="let s of todaysSlots">
              {{ slotLabel(s) }}
            </span>
          </div>

          <div class="mt-3">
            <a class="btn btn-primary" routerLink="/week">Go to Week</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent activity feed -->
  <div class="col-12 col-lg-6">
    <div class="card shadow-sm h-100">
      <div class="card-body">
        <h4 class="h6 mb-2">Recent activity</h4>

        <div *ngIf="activity.length === 0" class="text-muted">
          No bookings yet for this week.
        </div>

        <div *ngIf="activity.length" class="list-group">
          <div class="list-group-item" *ngFor="let a of activity">
            <div class="d-flex justify-content-between align-items-center">
              <div class="fw-semibold">
                {{ formatIsoDateDMY(a.date) }} ·
                {{ formatTimeHHmm(a.startTime) }} - {{ formatTimeHHmm(a.endTime) }}
              </div>
              <div class="text-muted small">
                booked: {{ formatBookedAt(a.bookedAt) }}
              </div>
            </div>

            <div class="text-muted small mt-1">
              {{ a.workoutPreview }}
            </div>
          </div>

          <div class="mt-3">
            <a class="btn btn-outline-primary" routerLink="/week">Open Week</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>